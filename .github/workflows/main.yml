name: learn-github-actions
on:
  workflow_dispatch:
  push:
    branches: [ "master" ]
jobs:
  build-go:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: 配置node语言环境
        uses: actions/setup-node@v3.5.1

      - name: 构建程序
        run:  npm run build

      - name: 向服务器传输可执行程序
        uses: appleboy/scp-action@master
        with:
          host: ${{ secrets.HOST }}  
          username: ${{ secrets.HUAWEI_USERNAME }} 
          port: ${{ secrets.SSH_PORT }} 
          password: ${{ secrets.HUAWEI_PASSWORD }}
          source: "./dist/*" 
          target: "/usr/share/nginx/html/bookRoom"
          strip_components: 2
          overwrite: true
